\documentclass{article}

\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{tikz}
\usepackage{float}
\usepackage{wrapfig,lipsum}
\usepackage{svg}
\usepackage{mathtools}
\usepackage{tabu}
%\usepackage{subcaption}
\usepackage{subfigure}
\usepackage[a4paper, total={6in, 8in}]{geometry}

\begin{document}


\newcommand{\vecthreeBF}[1]{\vec{\textbf{#1}}}
\newcommand{\vecthree}[1]{\vec{#1}}

\newcommand{\parDeriv}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\parDerivS}[2]{\frac{\partial^2 #1}{\partial #2^2}}
\newcommand{\deriv}[2]{\frac{d #1}{d #2}}
\newcommand{\derivS}[2]{\frac{d^2 #1}{d#2^2}}

\newcommand{\dotProdBF}[2]{\vecthreeBF{#1} \cdot \vecthreeBF{#2}}
\newcommand{\dotProd}[2]{\vecthree{#1} \cdot \vecthree{#2}}

\newcommand{\crossProdBF}[2]{\vecthreeBF{#1} \times \vecthreeBF{#2}}
\newcommand{\crossProd}[2]{\vecthree{#1} \times \vecthree{#2}}


\newcommand{\fromeq}[1]{\textit{equation \ref{eq:#1}}}
\newcommand{\fromeqs}[2]{\textit{equations \ref{eq:#1} and \ref{eq:#2}}}

\newcommand{\fromfig}[1]{\textit{figure \ref{fig:#1}}}


%%%%%%
\clearpage
\section{Algorithms}

\subsection{Leapfrog} \label{sec:leapfrog}
The Leapfrog method is a numerical method commonly used to solve ordinary differential equations (ODEs) that involve second-order time derivatives. Such an ODE can be written as
\vspace{-10pt}\begin{equation}
    \ddot{x} = \derivS{x}{t} = f(x) .\label{eq:second-order-ODE}
\vspace{-10pt}\end{equation}

The Leapfrog method is a variant of the finite difference method, and it approximates the solution of an ODE by discretizing both time and space. The method gets its name from the way it calculates the values of the solution at each time step, which resembles a "leapfrogging" motion. 
It is a simple and efficient algorithm that is often used in simulations of physical systems, such as celestial mechanics or molecular dynamics.
The idea is straight forward; in the time interval $\Delta t$, 
\vspace{-10pt}\begin{eqnarray}
    a(t_0) &=& f(x_0)   , \\
    x(t_0 + \Delta t) &=& x(t_0) + v(t_0)\Delta t + a(t_0)\frac{\Delta t^2}{2}   ,\label{eq:leapfrog_sync_x}\\
    v(t_0 + \Delta t) &=& v(t_0) + \{ a(t_0) + a(t_0 + \Delta t)\}\frac{\Delta t}{2} . \label{eq:leapfrog_sync_v}
\vspace{-10pt}\end{eqnarray}
For more stability, this version can be rearranged to what is called 'kick-drift-kick' form as
\vspace{-10pt}\begin{eqnarray} \label{eq:leapfrog}
    v(t_0 + \Delta t/2) &=& v(t_0) +  a(t_0)\frac{\Delta t}{2}   ,  \\
    x(t_0 + \Delta t) &=& x(t_0) + v(t_0 + \Delta t/2)\Delta t   , \\
    v(t_0 + \Delta t) &=& v(t_0 + \Delta t/2) + a(t_0 + \Delta t)\frac{\Delta t}{2} . 
\vspace{-10pt}\end{eqnarray}
This version provides more time resolution to our calculation; however, it increases the number of calculations needed by about $50\%$.

\subsection{Runge Kutta} \label{sec:rungekutta}

The Runge-Kutta methods, named after the German mathematicians Carl Runge and Martin Wilhelm Kutta \cite{runge} \cite{kutta}, 
family of numerical methods
used to solve ordinary differential equations (ODEs) that are in the form as
\vspace{-10pt}\begin{equation} \label{eq:first-order-ODE}
    \deriv{y}{x} = f(x, y) .
\vspace{-10pt}\end{equation}
The basic idea behind the Runge-Kutta method is to approximate the solution of an ODE by taking small steps and using a weighted average 
of function evaluations at different points within each step as
\vspace{-10pt}\begin{equation} \label{eq:general-rk}
    \begin{aligned}
        y_{n+1} = y_n + \delta x \sum_{i=1}^{m} b_i k_i  ,
    \end{aligned}
    \qquad
    \begin{aligned}
        x_{n+1} = x_n + \delta x   ,
    \end{aligned}
\vspace{-10pt}\end{equation}
where 
\vspace{-10pt}\begin{eqnarray} \label{eq:general-rk-coef}
    k_i = f(x_n + c_i \delta x, y_n + \delta x \sum_{j = 1}^{i - 1}a_{ij}k_j) .
\vspace{-10pt}\end{eqnarray}
These \fromeqs{general-rk}{general-rk-coef} define the family of methods. To specify a particular method, order $m$, coefficients $a_{ij}$, $b_i$ and $c_i$ should be provided.
The coefficients of any Runge-Kutta method can be visualized by a tableau called $\textit{Butcher Tableau}$ which can be observed in \fromfig{Butcher}.
\begin{figure}[h!]
    \[ 
    \begin{array} 
        {c|cccc}
        0\\
        c_1 & a_{21} \\
        c_2 & a_{31} & a_{32}\\
        \vdots& & \cdots& \\
        c_m & a_{m1} & a_{m2} & \cdots & a_{m,m-1}\\
        \hline
        & b_1 & b_2 &\cdots & b_m
    \end{array}
    \]
    \caption{Butcher Tableau.}
    \label{fig:Butcher}
\end{figure}

The simplest Runge-Kutta method is the \textit{Euler's method} with the following \textit{Butcher tableau},

\begin{figure}[h!]
\[ 
    \begin{array} 
        {c|cccc}
        0\\
        \hline
        & 1
    \end{array} .
\] 
\caption{Butcher tableau of Euler's method.}
\label{fig:Butcher_euler}
\end{figure}

The most commonly used version of the Runge-Kutta method is the fourth-order Runge-Kutta method, also known as RK4. 
The RK4 method involves four function evaluations per step and has an error term that is proportional to the step size raised to the fifth power.
Two of the most used \textit{Butcher tableaus} for \textit{RK4} given in \fromfig{Butcher-RK4}.
The second tableau in \fromfig{Butcher-RK4} is called the \textit{"3/8 rule"}. Its main advantage is that its error coefficients are smaller than the other. But it costs more floating point operations per step. 
Resulting in slower calculations. 

\begin{figure}[h!]
    \centering
    \begin{minipage}{.5\textwidth}
        \[ 
        \begin{array} 
            {c|cccc}
            0\\
            1/2 & 1/2 \\
            1/2 & 0 & 1/2 \\
            1   & 0 & 0 & 1\\
            \hline
            & 1/6 & 1/3 & 1/3 & 1/6
        \end{array}
        \]  
    \end{minipage}%
    \begin{minipage}{.5\textwidth}
        \[ 
        \begin{array} 
            {c|cccc}
            0\\
            1/3 & 1/3 \\
            2/3 & -1/3 & 1 \\
            1   & 1 & -1 & 1\\
            \hline
            & 1/8 & 3/8 & 3/8 & 1/8
        \end{array}
        \]  
    \end{minipage}
    \vspace{20pt}
    \caption{Butcher Tableau for RK4.}
    \label{fig:Butcher-RK4}
\end{figure}

%%%%%%


\begin{thebibliography}{9}
\bibitem{leapfrog_osc}
C. K. Birdsall and A. B. Langdon, \emph{Plasma Physics via Computer Simulations}, McGraw-Hill Book Company, 1985, p. 56.
\end{thebibliography}

\end{document}